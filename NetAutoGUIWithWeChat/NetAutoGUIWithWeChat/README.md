# NetAutoGUI 微信自动化程序

这个程序使用 NetAutoGUI 库来自动化微信的搜索和消息发送功能。

## ✅ 编译状态

程序已成功编译，所有编译错误已解决：
- ✅ VirtualKeyCode 枚举值问题已修复
- ✅ Window.GetWindowRect 方法问题已解决
- ✅ 无法访问的代码警告已修复

## 功能特性

### 多种搜索框定位方法
1. **图像识别定位** - 使用 Search.png 图片识别搜索框位置
2. **快捷键激活** - 使用 Ctrl+F 快捷键激活搜索功能
3. **相对坐标定位** - 基于固定坐标点击搜索框
4. **Tab键导航** - 使用Tab键导航到搜索框

### 多种消息发送方法
1. **发送按钮识别** - 使用 SendButton.png 图片识别发送按钮
2. **回车键发送** - 使用 Enter 键发送消息
3. **Ctrl+Enter发送** - 使用 Ctrl+Enter 组合键发送

## 使用方法

### 准备工作
1. 确保微信已安装并可以正常运行
2. 准备以下图片文件（放在程序目录下）：
   - `Search.png` - 搜索框的截图
   - `SendButton.png` - 发送按钮的截图  
   - `WeChatIcon.png` - 微信托盘图标的截图

### 编译和运行
```bash
# 编译程序
dotnet build

# 运行程序
dotnet run
```

### 程序执行流程
1. 查找或启动微信窗口
2. 激活微信窗口
3. 定位搜索框（尝试多种方法）
4. 搜索"微信助手"联系人
5. 发送预设消息

## 配置说明

### 搜索目标
在 `Program.cs` 中修改搜索的联系人：
```csharp
SearchHelper.SearchContact("你要搜索的联系人名称");
```

### 消息内容
在 `Program.cs` 中修改要发送的消息：
```csharp
string message = "你要发送的消息内容";
```

### 坐标调整
如果图像识别失败，可能需要调整 `SearchHelper.cs` 中的坐标：
```csharp
int searchBoxX = 200; // 调整这个值
int searchBoxY = 50;  // 调整这个值
```

## 技术实现细节

### VirtualKeyCode 修复
由于 NetAutoGUI 的 VirtualKeyCode 枚举与标准 Windows VK 代码不完全一致，程序使用了以下解决方案：
- 使用十六进制值直接转换：`(VirtualKeyCode)0x11` (Ctrl)
- 使用十六进制值直接转换：`(VirtualKeyCode)0x41` (A键)
- 使用十六进制值直接转换：`(VirtualKeyCode)0x46` (F键)
- 保留原有的 `VirtualKeyCode.RETURN` 用于回车键

### 错误处理
程序包含完善的错误处理机制：
- 每种定位方法都有独立的异常处理
- 提供详细的错误信息和状态反馈
- 多重备选方案确保程序稳定性

## 故障排除

### 常见问题

1. **找不到微信窗口**
   - 确保微信已启动
   - 检查微信窗口标题是否为"微信"
   - 确保 WeChatIcon.png 文件存在且正确

2. **搜索框定位失败**
   - 检查 Search.png 文件是否存在
   - 尝试重新截取搜索框图片
   - 调整图像匹配的置信度阈值

3. **消息发送失败**
   - 检查 SendButton.png 文件是否存在
   - 确保已选中正确的聊天对象
   - 尝试手动测试快捷键是否有效

### 调试技巧

1. **启用详细日志**
   程序会输出详细的执行状态，观察控制台输出来定位问题

2. **图片文件检查**
   确保图片文件清晰、尺寸适中，背景简单

3. **分辨率适配**
   不同分辨率下坐标可能需要调整

## 技术说明

### 依赖项
- .NET 10.0
- NetAutoGUI.Windows 3.0.1

### 核心类说明

- `Program.cs` - 主程序入口
- `SearchHelper.cs` - 搜索和消息发送的辅助方法

### 安全注意事项
- 程序会自动控制鼠标和键盘
- 运行时请勿手动操作鼠标键盘
- 建议在测试环境中先验证功能

## 扩展功能

可以基于现有代码扩展以下功能：
- 批量发送消息给多个联系人
- 定时发送消息
- 发送图片、文件等多媒体内容
- 自动回复功能
- 群组管理功能

## 许可证

本项目仅供学习和研究使用，请遵守相关法律法规和微信使用条款。